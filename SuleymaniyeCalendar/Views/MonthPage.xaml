<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="SuleymaniyeCalendar.Views.MonthPage"
             xmlns:localization="clr-namespace:LocalizationResourceManager.Maui;assembly=LocalizationResourceManager.Maui"
             xmlns:viewModels="clr-namespace:SuleymaniyeCalendar.ViewModels"
             Title="{Binding Title}" 
             x:DataType="viewModels:MonthViewModel"
             FlowDirection="{DynamicResource FlowDirection}">

<ContentPage.Content>
    <Grid RowDefinitions="*,Auto" Padding="4" RowSpacing="4">

        <!-- Main content area -->
        <Grid Grid.Row="0">
            <!-- Lightweight host; we will inject the heavy table after first frame -->
            <ContentView x:Name="ListHost" />

            <!-- Loading Indicator Overlay - shows above everything when loading -->
            <Grid IsVisible="{Binding IsBusy}" 
                  BackgroundColor="{AppThemeBinding Light=#80FFFFFF, Dark=#80000000}"
                  InputTransparent="False">
                <Border Style="{StaticResource Card}" 
                        VerticalOptions="Center" 
                        HorizontalOptions="Center"
                        Padding="40,24"
                        BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceVariantColor}, Dark={StaticResource SurfaceVariantColorDark}}">
                    <VerticalStackLayout Spacing="16" HorizontalOptions="Center">
                        <ActivityIndicator IsRunning="{Binding IsBusy}"
                                           Color="{StaticResource PrimaryColor}"
                                           HeightRequest="48"
                                           WidthRequest="48" />
                        <Label Text="{localization:Translate IcerikYukleniyor}"
                               Style="{StaticResource TitleMediumLabel}"
                               HorizontalTextAlignment="Center"
                               TextColor="{StaticResource PrimaryColor}" />
                    </VerticalStackLayout>
                </Border>
            </Grid>
        </Grid>

        <!-- Action Buttons -->
        <Grid Grid.Row="1" ColumnDefinitions="*,*,*" ColumnSpacing="12">
            <Button Grid.Column="0"
                    Text="{localization:Translate Kapat}" 
                    Command="{Binding GoBackCommand}" 
                    Style="{StaticResource OutlineButton}" />
            <Button Grid.Column="1"
                    IsVisible="{Binding ShowShare}"
                    Text="{localization:Translate Paylas}" 
                    Command="{Binding ShareCommand}" 
                    Style="{StaticResource WarningButton}" />
            <Button Grid.Column="2"
                    Text="{localization:Translate KonumYenileButton}" 
                    Command="{Binding RefreshCommand}" 
                    Style="{StaticResource PrimaryButton}"
                    IsEnabled="{Binding IsNotBusy}" />
        </Grid>
    </Grid>
</ContentPage.Content>

</ContentPage>