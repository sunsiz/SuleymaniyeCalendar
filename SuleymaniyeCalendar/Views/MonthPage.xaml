<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="SuleymaniyeCalendar.Views.MonthPage"
             xmlns:localization="clr-namespace:LocalizationResourceManager.Maui;assembly=LocalizationResourceManager.Maui"
             xmlns:viewModels="clr-namespace:SuleymaniyeCalendar.ViewModels"
             Title="{Binding Title}" 
             x:DataType="viewModels:MonthViewModel"
             FlowDirection="{DynamicResource FlowDirection}"
             Background="{AppThemeBinding Light={StaticResource AppBackgroundLight}, Dark={StaticResource AppBackgroundDark}}">

<ContentPage.Content>
    <Grid RowDefinitions="*,Auto" Padding="{StaticResource SpacingXS}" RowSpacing="{StaticResource SpacingXS}">

        <!-- Main content area -->
        <Grid Grid.Row="0">
            <!-- Lightweight host; we will inject the heavy table after first frame -->
            <ContentView x:Name="ListHost" />

            <!--  Loading Indicator Overlay  -->
            <Grid IsVisible="{Binding IsBusy}" 
                  BackgroundColor="{AppThemeBinding Light={StaticResource BusyOverlayColorDark}, Dark={StaticResource BusyOverlayColor}}">
                <Border Style="{StaticResource FrostGlassCardCrystal}" 
                    VerticalOptions="Center" 
                    HorizontalOptions="Center"
                    Padding="32,20"
                    MinimumWidthRequest="200"
                    MaximumHeightRequest="200">
                    <VerticalStackLayout Spacing="12" HorizontalOptions="Center" VerticalOptions="Center">
                        <ActivityIndicator IsRunning="{Binding IsBusy}"
                                           Style="{StaticResource GoldenActivityIndicator}"
                                           HeightRequest="80"
                                           WidthRequest="80" />
                        <Label Text="{localization:Translate IcerikYukleniyor}"
                               Style="{StaticResource TitleMediumStyle}"
                               HorizontalTextAlignment="Center"
                               TextColor="{StaticResource PrimaryColor}" />
                    </VerticalStackLayout>
                </Border>
            </Grid>

            <!--  Extended overlay  -->
            <Grid IsVisible="{Binding ShowOverlay}" BackgroundColor="#80000000">
                <Border Style="{StaticResource FrostGlassCardCrystal}" Padding="32,20" HorizontalOptions="Center" VerticalOptions="Center">
                    <VerticalStackLayout Spacing="12" HorizontalOptions="Center">
                        <ActivityIndicator IsRunning="True" Style="{StaticResource GoldenActivityIndicator}" WidthRequest="80" HeightRequest="80" />
                        <Label Text="{Binding OverlayMessage}" Style="{StaticResource BodyLargeStyle}" HorizontalTextAlignment="Center" />
                    </VerticalStackLayout>
                </Border>
            </Grid>
        </Grid>

        <!-- Action Buttons -->
        <Grid Grid.Row="1" ColumnDefinitions="*,*,*" ColumnSpacing="12">
            <Button Grid.Column="0"
                    Style="{StaticResource GlassButtonOutline}"
                    TextColor="{AppThemeBinding Light={StaticResource CardValueLight}, Dark={StaticResource CardValueDark}}"
                    Text="{localization:Translate Kapat}"
                    Command="{Binding GoBackCommand}" />
            <Button Grid.Column="1"
                    Style="{StaticResource GlassButtonWarning}"
                    IsVisible="{Binding ShowShare}"
                    TextColor="{AppThemeBinding Light={StaticResource CardValueLight}, Dark={StaticResource CardValueDark}}"
                    Text="{localization:Translate Paylas}"
                    Command="{Binding ShareCommand}" />
            <Button Grid.Column="2"
                    Style="{StaticResource GlassButtonPrimaryIntense}"
                    TextColor="{AppThemeBinding Light={StaticResource CardValueLight}, Dark={StaticResource CardValueDark}}"
                    Text="{localization:Translate KonumYenileButton}"
                    Command="{Binding RefreshCommand}"
                    IsEnabled="{Binding IsNotBusy}" />
        </Grid>
    </Grid>
</ContentPage.Content>

</ContentPage>