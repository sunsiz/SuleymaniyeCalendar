<?xml version="1.0" encoding="utf-8" ?>

<ContentPage
    x:Class="SuleymaniyeCalendar.Views.RadioPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:localization="clr-namespace:LocalizationResourceManager.Maui;assembly=LocalizationResourceManager.Maui"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:viewModels="clr-namespace:SuleymaniyeCalendar.ViewModels"
    Title="{Binding Title}"
    x:DataType="viewModels:RadioViewModel"
    FlowDirection="{DynamicResource FlowDirection}"
    Background="{AppThemeBinding Light={StaticResource AppBackgroundBrushLight}, Dark={StaticResource AppBackgroundBrushDark}}">

    <Shell.TitleView>
        <StackLayout
            Margin="10"
            HeightRequest="34"
            Orientation="Horizontal">
            <Label
                AutomationProperties.IsInAccessibleTree="True"
                Style="{StaticResource LabelSectionHeader}"
                Text="{localization:Translate FitratinSesi}" />
        </StackLayout>
    </Shell.TitleView>

    <ContentPage.Content>
        <VerticalStackLayout Spacing="0" Padding="0,8,0,0">
            <!-- Hero Card Header -->
            <Border Style="{StaticResource HeroCard}" Margin="16,0,16,12" Padding="20,18">
                <Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">
                    <Label Grid.Column="0"
                           FontFamily="{StaticResource IconFontFamily}"
                           FontSize="38"
                           Text="&#xf001;"
                           TextColor="{AppThemeBinding Light={StaticResource GoldPure}, Dark={StaticResource GoldMedium}}"
                           VerticalOptions="Center"
                           HorizontalTextAlignment="Center"
                           FontAttributes="Bold" />
                    <VerticalStackLayout Grid.Column="1" Spacing="2" VerticalOptions="Center">
                        <Label Style="{StaticResource TitleLargeStyle}"
                               Text="{localization:Translate FitratinSesi}" />
                        <Label Style="{StaticResource BodyLargeStyle}"
                               Text="{localization:Translate FitratinSesi}" Opacity="0.8" />
                    </VerticalStackLayout>
                </Grid>
            </Border>

            <BoxView Style="{StaticResource Divider}" Margin="0,0,0,8" />

            <!-- Premium Card for Radio Controls -->
            <Border Style="{StaticResource GlassMediaCard}" Margin="16,0,16,0">
                <Grid Padding="{StaticResource CardPaddingDefault}"
                      ColumnDefinitions="*,Auto,*"
                      RowDefinitions="Auto"
                      ColumnSpacing="{StaticResource SpacingLG}"
                      VerticalOptions="Center">
                    <StackLayout Grid.Row="0" Grid.Column="0" VerticalOptions="Center">
                        <Label Style="{DynamicResource LabelStyle}" VerticalTextAlignment="Center">
                            <Label.FormattedText>
                                <FormattedString>
                                    <Span FontFamily="{StaticResource IconFontFamily}"
                                          FontSize="{DynamicResource IconLargeFontSize}"
                                          Text="&#xf0ae; "
                                          TextColor="{AppThemeBinding Light=#3A2E1C, Dark={StaticResource GoldMedium}}" />
                                    <Span Text="{localization:Translate YayinAkisi}"
                                          FontSize="{DynamicResource BodyFontSize}"
                                          TextColor="{AppThemeBinding Light=#3A2E1C, Dark={StaticResource GoldMedium}}" />
                                </FormattedString>
                            </Label.FormattedText>
                        </Label>
                        <StackLayout.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding TapCommand}" CommandParameter="https://www.instagram.com/radyofitrat/" />
                        </StackLayout.GestureRecognizers>
                    </StackLayout>

                    <!-- Enhanced Play / Pause control with golden circular design -->
                    <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource HeroCard}" Margin="0" Padding="0" HorizontalOptions="Center" VerticalOptions="Center">
                        <Label Padding="0"
                               AutomationProperties.IsInAccessibleTree="True"
                               FontAttributes="Bold"
                               FontFamily="{StaticResource IconFontFamily}"
                               FontSize="{DynamicResource IconXLFontSize}"
                               HorizontalOptions="Center"
                               SemanticProperties.Description="{localization:Translate RadyoCal}"
                               Text="&#xf144;"
                               TextColor="{AppThemeBinding Light={StaticResource GoldOrange}, Dark={StaticResource GoldDeep}}"
                               VerticalOptions="Center">
                            <Label.Triggers>
                                <DataTrigger Binding="{Binding IsPlaying}" TargetType="Label" Value="False">
                                    <Setter Property="Text" Value="&#xf144;" />
                                    <Setter Property="SemanticProperties.Description" Value="{localization:Translate Oynat}" />
                                    <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource GoldOrange}, Dark={StaticResource GoldDeep}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsPlaying}" TargetType="Label" Value="True">
                                    <Setter Property="Text" Value="&#xf28b;" />
                                    <Setter Property="SemanticProperties.Description" Value="{localization:Translate Durdur}" />
                                    <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource Warning60}, Dark={StaticResource Warning30}}" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding PlayCommand}" NumberOfTapsRequired="1" />
                        </Border.GestureRecognizers>
                    </Border>

                    <StackLayout Grid.Row="0" Grid.Column="2" VerticalOptions="Center">
                        <Label HorizontalTextAlignment="End" Style="{DynamicResource LabelStyle}" VerticalTextAlignment="Center">
                            <Label.FormattedText>
                                <FormattedString>
                                    <Span FontFamily="{StaticResource IconFontFamily}"
                                          FontSize="{DynamicResource IconLargeFontSize}"
                                          Text="&#xf0ac; "
                                          TextColor="{AppThemeBinding Light=#3A2E1C, Dark={StaticResource GoldMedium}}" />
                                    <Span Text="{localization:Translate WebSayfa}"
                                          FontSize="{DynamicResource BodyFontSize}"
                                          TextColor="{AppThemeBinding Light=#3A2E1C, Dark={StaticResource GoldMedium}}" />
                                </FormattedString>
                            </Label.FormattedText>
                        </Label>
                        <StackLayout.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding TapCommand}" CommandParameter="https://www.radyofitrat.com/" />
                        </StackLayout.GestureRecognizers>
                    </StackLayout>
                </Grid>
            </Border>

            <toolkit:MediaElement x:Name="RadioPlayer" Margin="0" AndroidViewType="TextureView" HeightRequest="1" HorizontalOptions="Fill" IsVisible="False" MetadataArtist="{localization:Translate SuleymaniyeVakfi}" MetadataArtworkUrl="https://www.radyofitrat.com/img/radyo-fitrat.png" MetadataTitle="{localization:Translate RadyoFitrat}" ShouldAutoPlay="False" ShouldMute="False" CurrentState="Buffering" ShouldShowPlaybackControls="False" Source="https://www.suleymaniyevakfi.org/radio.mp3" VerticalOptions="End" />
        

            <!-- ðŸŽ¨ PHASE 15: Busy overlay with ElevatedPrimaryCard + GoldenActivityIndicator -->
            <Grid BackgroundColor="#80000000" IsVisible="{Binding IsBusy}">
                <Border Style="{StaticResource ElevatedPrimaryCard}" Padding="32,20" HorizontalOptions="Center" VerticalOptions="Center">
                    <ActivityIndicator IsRunning="True" Style="{StaticResource GoldenActivityIndicator}" WidthRequest="40" HeightRequest="40" />
                </Border>
            </Grid>
        </VerticalStackLayout>
    </ContentPage.Content>

</ContentPage>