<?xml version="1.0" encoding="utf-8" ?>
<!-- ðŸ—“ï¸ PHASE 20: Calendar Grid Month View - Beautiful Calendar UI -->
<ContentView
    x:Class="SuleymaniyeCalendar.Views.MonthCalendarView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:localization="clr-namespace:LocalizationResourceManager.Maui;assembly=LocalizationResourceManager.Maui"
    xmlns:models="clr-namespace:SuleymaniyeCalendar.Models"
    xmlns:viewModels="clr-namespace:SuleymaniyeCalendar.ViewModels"
    x:DataType="viewModels:MonthViewModel"
    FlowDirection="{DynamicResource FlowDirection}">

    <ScrollView x:Name="MainScrollView">
        <VerticalStackLayout Spacing="{StaticResource SpacingMD}" Padding="{StaticResource SpacingXS}">
            
            <!-- ðŸŽ¯ PHASE 20.2: Unified Calendar Card with Integrated Navigation -->
            <!-- ðŸŽ¨ PHASE 20.2C: Added swipe gestures for month navigation -->
            <Border Style="{StaticResource FrostGlassCardCrystal}" Padding="12">
                <Border.GestureRecognizers>
                    <!-- Swipe Left â†’ Next Month -->
                    <SwipeGestureRecognizer Direction="Left" Command="{Binding NextMonthCommand}" />
                    <!-- Swipe Right â†’ Previous Month -->
                    <SwipeGestureRecognizer Direction="Right" Command="{Binding PreviousMonthCommand}" />
                </Border.GestureRecognizers>
                
                <VerticalStackLayout Spacing="8">
                    
                    <!-- ðŸ“ Navigation Header (Compact) -->
                    <Grid ColumnDefinitions="36,*,36,Auto" ColumnSpacing="6">
                        <!-- Previous Month -->
                        <Button Grid.Column="0"
                                Text="â—€"
                                Style="{StaticResource GlassButtonOutline}"
                                FontSize="16"
                                WidthRequest="36"
                                HeightRequest="36"
                                Padding="0"
                                Command="{Binding PreviousMonthCommand}" />
                        
                        <!-- Month/Year Title (Centered) -->
                        <Label Grid.Column="1"
                               Text="{Binding MonthYearDisplay}"
                               Style="{StaticResource TitleMediumStyle}"
                               HorizontalTextAlignment="Center"
                               VerticalTextAlignment="Center"
                               TextColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource Primary50}}" />
                        
                        <!-- Next Month -->
                        <Button Grid.Column="2"
                                Text="â–¶"
                                Style="{StaticResource GlassButtonOutline}"
                                FontSize="16"
                                WidthRequest="36"
                                HeightRequest="36"
                                Padding="0"
                                Command="{Binding NextMonthCommand}" />
                        
                        <!-- Today Button (Localized) -->
                        <Button Grid.Column="3"
                                Text="{localization:Translate Bugun}"
                                Style="{StaticResource iOSLiquidGlassButton}"
                                FontSize="12"
                                Padding="12,0"
                                HeightRequest="32"
                                VerticalOptions="Center"
                                Command="{Binding TodayCommand}" />
                    </Grid>
                    
                    <!-- ðŸŒ Weekday Headers -->
                    <Grid ColumnDefinitions="*,*,*,*,*,*,*" ColumnSpacing="4">
                        <Label Grid.Column="0" Text="{Binding WeekdayHeaders[0]}" 
                               Style="{StaticResource LabelMediumStyle}"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}" />
                        <Label Grid.Column="1" Text="{Binding WeekdayHeaders[1]}" 
                               Style="{StaticResource LabelMediumStyle}"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}" />
                        <Label Grid.Column="2" Text="{Binding WeekdayHeaders[2]}" 
                               Style="{StaticResource LabelMediumStyle}"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}" />
                        <Label Grid.Column="3" Text="{Binding WeekdayHeaders[3]}" 
                               Style="{StaticResource LabelMediumStyle}"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}" />
                        <Label Grid.Column="4" Text="{Binding WeekdayHeaders[4]}" 
                               Style="{StaticResource LabelMediumStyle}"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}" />
                        <Label Grid.Column="5" Text="{Binding WeekdayHeaders[5]}" 
                               Style="{StaticResource LabelMediumStyle}"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}" />
                        <Label Grid.Column="6" Text="{Binding WeekdayHeaders[6]}" 
                               Style="{StaticResource LabelMediumStyle}"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}" />
                    </Grid>

                    <!-- ðŸš€ PHASE 20.1D: Calendar Days Grid (Fast Grid instead of CollectionView) -->
                    <!-- 7 columns Ã— 6 rows = 42 cells max -->
                    <Grid x:Name="CalendarGrid"
                          ColumnDefinitions="*,*,*,*,*,*,*"
                          RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto"
                          ColumnSpacing="4"
                          RowSpacing="4" />
                    
                    <!-- ðŸ“¥ Download Prompt: Shown when navigating to months without cached data -->
                    <!-- ðŸ”§ Made compact with FlexLayout for better wrapping -->
                    <Border Style="{StaticResource FrostGlassCardCrystal}"
                            Padding="10,6"
                            IsVisible="{Binding ShowDownloadPrompt}">
                        <FlexLayout Direction="Row" 
                                    Wrap="Wrap" 
                                    JustifyContent="Center" 
                                    AlignItems="Center"
                                    AlignContent="Center">
                            <Label Text="ðŸ“…" 
                                   FontSize="18" 
                                   Margin="0,0,8,0" />
                            <Label Text="{localization:Translate AylikVeriYenilemeIste}"
                                   Style="{StaticResource BodySmallStyle}"
                                   Margin="0,0,10,0"
                                   TextColor="{AppThemeBinding Light={StaticResource OnSurfaceColor}, Dark={StaticResource OnSurfaceDarkColor}}" />
                            <Button Text="{localization:Translate AyVeriYukle}"
                                    Style="{StaticResource iOSLiquidGlassButton}"
                                    Command="{Binding DownloadDisplayedMonthCommand}"
                                    HeightRequest="28"
                                    FontSize="12"
                                    Padding="12,2" />
                        </FlexLayout>
                    </Border>
                    
                    <!-- ðŸ”„ Loading Indicator for Month Download -->
                    <ActivityIndicator IsRunning="{Binding IsLoadingMonth}"
                                       IsVisible="{Binding IsLoadingMonth}"
                                       Color="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource Primary50}}"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"
                                       HeightRequest="24"
                                       WidthRequest="24" />
                    
                </VerticalStackLayout>
            </Border>

            <!-- ðŸ“– Selected Day Detail Card with Enhanced Design -->
            <!-- ðŸŽ¨ PHASE 20.2C: Named for fade-in animation -->
            <Border x:Name="SelectedDayCard"
                    Style="{StaticResource FrostGlassCardFrozen}" 
                    Padding="20,16"
                    IsVisible="{Binding HasSelectedDayData}">
                <VerticalStackLayout Spacing="9">
                    <!-- Selected Date Header with Icon -->
                    <!--<HorizontalStackLayout Spacing="8">
                        <Label Text="ðŸ“–" FontSize="20" VerticalOptions="Center" />-->
                        <Label Text="{Binding SelectedDate, StringFormat='{0:dddd, dd MMMM yyyy}'}"
                               Style="{StaticResource TitleMediumStyle}"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource Primary50}}" />
                    <!--</HorizontalStackLayout>-->
                    
                    <!-- ðŸŽ¨ Subtle Divider -->
                    <BoxView HeightRequest="1" 
                             Opacity="0.15"
                             Color="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}" />
                    
                    <!-- ðŸ“– Prayer Times Grid - Improved Visual Hierarchy -->
                    <Grid ColumnDefinitions="*,Auto" 
                          RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto"
                          ColumnSpacing="20"
                          RowSpacing="12">
                        
                        <!-- Fajr -->
                        <Label Grid.Row="0" Grid.Column="0" 
                               Text="{localization:Translate FecriKazip}"
                               Style="{StaticResource BodyMediumStyle}"
                               VerticalOptions="Center" />
                        <Label Grid.Row="0" Grid.Column="1" 
                               Text="{Binding SelectedDayData.FalseFajr}"
                               Style="{StaticResource TitleSmallStyle}"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}"
                               HorizontalTextAlignment="End" />
                        
                        <!-- True Fajr -->
                        <Label Grid.Row="1" Grid.Column="0" 
                               Text="{localization:Translate FecriSadik}"
                               Style="{StaticResource BodyMediumStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                        <Label Grid.Row="1" Grid.Column="1" 
                               Text="{Binding SelectedDayData.Fajr}"
                               Style="{StaticResource TitleSmallStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource Primary50}}"
                               HorizontalTextAlignment="End" />
                        
                        <!-- Sunrise -->
                        <Label Grid.Row="2" Grid.Column="0" 
                               Text="{localization:Translate SabahSonu}"
                               Style="{StaticResource BodyMediumStyle}"
                               VerticalOptions="Center" />
                        <Label Grid.Row="2" Grid.Column="1" 
                               Text="{Binding SelectedDayData.Sunrise}"
                               Style="{StaticResource TitleSmallStyle}"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}"
                               HorizontalTextAlignment="End" />
                        
                        <!-- Dhuhr -->
                        <Label Grid.Row="3" Grid.Column="0" 
                               Text="{localization:Translate Ogle}"
                               Style="{StaticResource BodyMediumStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                        <Label Grid.Row="3" Grid.Column="1" 
                               Text="{Binding SelectedDayData.Dhuhr}"
                               Style="{StaticResource TitleSmallStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource Primary50}}"
                               HorizontalTextAlignment="End" />
                        
                        <!-- Asr -->
                        <Label Grid.Row="4" Grid.Column="0" 
                               Text="{localization:Translate Ikindi}"
                               Style="{StaticResource BodyMediumStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                        <Label Grid.Row="4" Grid.Column="1" 
                               Text="{Binding SelectedDayData.Asr}"
                               Style="{StaticResource TitleSmallStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource Primary50}}"
                               HorizontalTextAlignment="End" />
                        
                        <!-- Maghrib -->
                        <Label Grid.Row="5" Grid.Column="0" 
                               Text="{localization:Translate Aksam}"
                               Style="{StaticResource BodyMediumStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                        <Label Grid.Row="5" Grid.Column="1" 
                               Text="{Binding SelectedDayData.Maghrib}"
                               Style="{StaticResource TitleSmallStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource Primary50}}"
                               HorizontalTextAlignment="End" />
                        
                        <!-- Isha -->
                        <Label Grid.Row="6" Grid.Column="0" 
                               Text="{localization:Translate Yatsi}"
                               Style="{StaticResource BodyMediumStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                        <Label Grid.Row="6" Grid.Column="1" 
                               Text="{Binding SelectedDayData.Isha}"
                               Style="{StaticResource TitleSmallStyle}"
                               FontAttributes="Bold"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource Primary50}}"
                               HorizontalTextAlignment="End" />
                        
                        <!-- End of Isha -->
                        <Label Grid.Row="7" Grid.Column="0" 
                               Text="{localization:Translate YatsiSonu}"
                               Style="{StaticResource BodyMediumStyle}"
                               VerticalOptions="Center" />
                        <Label Grid.Row="7" Grid.Column="1" 
                               Text="{Binding SelectedDayData.EndOfIsha}"
                               Style="{StaticResource TitleSmallStyle}"
                               VerticalOptions="Center"
                               TextColor="{AppThemeBinding Light={StaticResource Primary80}, Dark={StaticResource Primary30}}"
                               HorizontalTextAlignment="End" />
                    </Grid>
                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>
</ContentView>
